import{b as K,d as m,_ as z,a as H,u as q,c as P,c6 as Fe,c7 as pe,aQ as Te,c8 as fe,az as ve,aM as me,H as ee,J as S,o as v,a1 as b,h as p,y as s,x as N,n as j,r as L,aq as W,g as _,w as R,j as Le,K as A,k as ye,aj as ge,am as he,bU as F,m as Q,a4 as Re,l as be,a7 as Ue,aV as De,a$ as ke,a6 as I,v as B,c9 as _e,ca as Oe,b6 as Be,cb as Ne,i as je,aC as Y,aN as te,aE as Ae,cc as Me,cd as qe,s as se,X as Ie,Q as Ke,p as ze,U as He,a2 as ae,L as oe}from"./index.js";import{t as x,f as V,d as We}from"./_plugin-vue_export-helper.js";import{f as Ve}from"./_baseClone.js";var Xe=1,Ge=4;function ne(r){return Ve(r,Xe|Ge)}const Je=K({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:r=>r>=0&&r<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:m(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:m([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:m(Function),default:r=>`${r}%`}}),Qe=["aria-valuenow"],Ye={viewBox:"0 0 100 100"},Ze=["d","stroke","stroke-linecap","stroke-width"],xe=["d","stroke","opacity","stroke-linecap","stroke-width"],et={key:0},tt=H({name:"ElProgress",__name:"progress",props:Je,setup(r){const d={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},t=r,i=q("progress"),y=P(()=>{const n={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},h=E(t.percentage);return h.includes("gradient")?n.background=h:n.backgroundColor=h,n}),u=P(()=>(t.strokeWidth/t.width*100).toFixed(1)),c=P(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(u.value)/2}`,10):0),T=P(()=>{const n=c.value,h=t.type==="dashboard";return`
          M 50 50
          m 0 ${h?"":"-"}${n}
          a ${n} ${n} 0 1 1 0 ${h?"-":""}${n*2}
          a ${n} ${n} 0 1 1 0 ${h?"":"-"}${n*2}
          `}),g=P(()=>2*Math.PI*c.value),w=P(()=>t.type==="dashboard"?.75:1),k=P(()=>`${-1*g.value*(1-w.value)/2}px`),$=P(()=>({strokeDasharray:`${g.value*w.value}px, ${g.value}px`,strokeDashoffset:k.value})),f=P(()=>({strokeDasharray:`${g.value*w.value*(t.percentage/100)}px, ${g.value}px`,strokeDashoffset:k.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),C=P(()=>{let n;return t.color?n=E(t.percentage):n=d[t.status]||d.default,n}),o=P(()=>t.status==="warning"?Fe:t.type==="line"?t.status==="success"?pe:Te:t.status==="success"?fe:ve),e=P(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),a=P(()=>t.format(t.percentage));function l(n){const h=100/n.length;return n.map((U,D)=>ee(U)?{color:U,percentage:(D+1)*h}:U).sort((U,D)=>U.percentage-D.percentage)}const E=n=>{var h;const{color:O}=t;if(me(O))return O(n);if(ee(O))return O;{const U=l(O);for(const D of U)if(D.percentage>n)return D.color;return(h=U[U.length-1])==null?void 0:h.color}};return(n,h)=>(v(),S("div",{class:p([s(i).b(),s(i).m(n.type),s(i).is(n.status),{[s(i).m("without-text")]:!n.showText,[s(i).m("text-inside")]:n.textInside}]),role:"progressbar","aria-valuenow":n.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[n.type==="line"?(v(),S("div",{key:0,class:p(s(i).b("bar"))},[N("div",{class:p(s(i).be("bar","outer")),style:j({height:`${n.strokeWidth}px`})},[N("div",{class:p([s(i).be("bar","inner"),{[s(i).bem("bar","inner","indeterminate")]:n.indeterminate},{[s(i).bem("bar","inner","striped")]:n.striped},{[s(i).bem("bar","inner","striped-flow")]:n.stripedFlow}]),style:j(y.value)},[(n.showText||n.$slots.default)&&n.textInside?(v(),S("div",{key:0,class:p(s(i).be("bar","innerText"))},[L(n.$slots,"default",{percentage:n.percentage},()=>[N("span",null,W(a.value),1)])],2)):b("v-if",!0)],6)],6)],2)):(v(),S("div",{key:1,class:p(s(i).b("circle")),style:j({height:`${n.width}px`,width:`${n.width}px`})},[(v(),S("svg",Ye,[N("path",{class:p(s(i).be("circle","track")),d:T.value,stroke:`var(${s(i).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":n.strokeLinecap,"stroke-width":u.value,fill:"none",style:j($.value)},null,14,Ze),N("path",{class:p(s(i).be("circle","path")),d:T.value,stroke:C.value,fill:"none",opacity:n.percentage?1:0,"stroke-linecap":n.strokeLinecap,"stroke-width":u.value,style:j(f.value)},null,14,xe)]))],6)),(n.showText||n.$slots.default)&&!n.textInside?(v(),S("div",{key:2,class:p(s(i).e("text")),style:j({fontSize:`${e.value}px`})},[L(n.$slots,"default",{percentage:n.percentage},()=>[n.status?(v(),_(s(A),{key:1},{default:R(()=>[(v(),_(Le(o.value)))]),_:1})):(v(),S("span",et,W(a.value),1))])],6)):b("v-if",!0)],10,Qe))}});var st=z(tt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const at=ye(st),$e=Symbol("uploadContextKey"),ot="ElUpload";class nt extends Error{constructor(d,t,i,y){super(d),this.name="UploadAjaxError",this.status=t,this.method=i,this.url=y}}function re(r,d,t){let i;return t.response?i=`${t.response.error||t.response}`:t.responseText?i=`${t.responseText}`:i=`fail to ${d.method} ${r} ${t.status}`,new nt(i,t.status,d.method,r)}function rt(r){const d=r.responseText||r.response;if(!d)return d;try{return JSON.parse(d)}catch{return d}}const lt=r=>{typeof XMLHttpRequest>"u"&&x(ot,"XMLHttpRequest is undefined");const d=new XMLHttpRequest,t=r.action;d.upload&&d.upload.addEventListener("progress",u=>{const c=u;c.percent=u.total>0?u.loaded/u.total*100:0,r.onProgress(c)});const i=new FormData;if(r.data)for(const[u,c]of Object.entries(r.data))ge(c)&&c.length?i.append(u,...c):i.append(u,c);i.append(r.filename,r.file,r.file.name),d.addEventListener("error",()=>{r.onError(re(t,r,d))}),d.addEventListener("load",()=>{if(d.status<200||d.status>=300)return r.onError(re(t,r,d));r.onSuccess(rt(d))}),d.open(r.method,t,!0),r.withCredentials&&"withCredentials"in d&&(d.withCredentials=!0);const y=r.headers||{};if(y instanceof Headers)y.forEach((u,c)=>d.setRequestHeader(c,u));else for(const[u,c]of Object.entries(y))he(c)||d.setRequestHeader(u,String(c));return d.send(i),d},we=["text","picture","picture-card"];let it=1;const Z=()=>Date.now()+it++,Ee=K({action:{type:String,default:"#"},headers:{type:m(Object)},method:{type:String,default:"post"},data:{type:m([Object,Function,Promise]),default:()=>Q({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:m(Array),default:()=>Q([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:we,default:"text"},httpRequest:{type:m(Function),default:lt},disabled:{type:Boolean,default:void 0},limit:Number}),ut=K({...Ee,beforeUpload:{type:m(Function),default:F},beforeRemove:{type:m(Function)},onRemove:{type:m(Function),default:F},onChange:{type:m(Function),default:F},onPreview:{type:m(Function),default:F},onSuccess:{type:m(Function),default:F},onProgress:{type:m(Function),default:F},onError:{type:m(Function),default:F},onExceed:{type:m(Function),default:F},crossorigin:{type:m(String)}}),dt=K({files:{type:m(Array),default:()=>Q([])},disabled:{type:Boolean,default:void 0},handlePreview:{type:m(Function),default:F},listType:{type:String,values:we,default:"text"},crossorigin:{type:m(String)}}),ct={remove:r=>!!r},pt=["tabindex","aria-disabled","onKeydown"],ft=["src","crossorigin"],vt=["onClick"],mt=["title"],yt=["onClick"],gt=["onClick"],ht=H({name:"ElUploadList",__name:"upload-list",props:dt,emits:ct,setup(r,{emit:d}){const t=r,i=d,{t:y}=Re(),u=q("upload"),c=q("icon"),T=q("list"),g=V(),w=be(!1),k=P(()=>[u.b("list"),u.bm("list",t.listType),u.is("disabled",g.value)]),$=f=>{i("remove",f)};return(f,C)=>(v(),_(Ne,{tag:"ul",class:p(k.value),name:s(T).b()},{default:R(()=>[(v(!0),S(Ue,null,De(f.files,(o,e)=>(v(),S("li",{key:o.uid||o.name,class:p([s(u).be("list","item"),s(u).is(o.status),{focusing:w.value}]),tabindex:s(g)?void 0:0,"aria-disabled":s(g),role:"button",onKeydown:ke(a=>!s(g)&&$(o),["delete"]),onFocus:C[0]||(C[0]=a=>w.value=!0),onBlur:C[1]||(C[1]=a=>w.value=!1),onClick:C[2]||(C[2]=a=>w.value=!1)},[L(f.$slots,"default",{file:o,index:e},()=>[f.listType==="picture"||o.status!=="uploading"&&f.listType==="picture-card"?(v(),S("img",{key:0,class:p(s(u).be("list","item-thumbnail")),src:o.url,crossorigin:f.crossorigin,alt:""},null,10,ft)):b("v-if",!0),o.status==="uploading"||f.listType!=="picture-card"?(v(),S("div",{key:1,class:p(s(u).be("list","item-info"))},[N("a",{class:p(s(u).be("list","item-name")),onClick:I(a=>f.handlePreview(o),["prevent"])},[B(s(A),{class:p(s(c).m("document"))},{default:R(()=>[B(s(_e))]),_:1},8,["class"]),N("span",{class:p(s(u).be("list","item-file-name")),title:o.name},W(o.name),11,mt)],10,vt),o.status==="uploading"?(v(),_(s(at),{key:0,type:f.listType==="picture-card"?"circle":"line","stroke-width":f.listType==="picture-card"?6:2,percentage:Number(o.percentage),style:j(f.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):b("v-if",!0)],2)):b("v-if",!0),N("label",{class:p(s(u).be("list","item-status-label"))},[f.listType==="text"?(v(),_(s(A),{key:0,class:p([s(c).m("upload-success"),s(c).m("circle-check")])},{default:R(()=>[B(s(pe))]),_:1},8,["class"])):["picture-card","picture"].includes(f.listType)?(v(),_(s(A),{key:1,class:p([s(c).m("upload-success"),s(c).m("check")])},{default:R(()=>[B(s(fe))]),_:1},8,["class"])):b("v-if",!0)],2),s(g)?b("v-if",!0):(v(),_(s(A),{key:2,class:p(s(c).m("close")),onClick:a=>$(o)},{default:R(()=>[B(s(ve))]),_:1},8,["class","onClick"])),b(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),b(" This is a bug which needs to be fixed "),b(" TODO: Fix the incorrect navigation interaction "),s(g)?b("v-if",!0):(v(),S("i",{key:3,class:p(s(c).m("close-tip"))},W(s(y)("el.upload.deleteTip")),3)),f.listType==="picture-card"?(v(),S("span",{key:4,class:p(s(u).be("list","item-actions"))},[N("span",{class:p(s(u).be("list","item-preview")),onClick:a=>f.handlePreview(o)},[B(s(A),{class:p(s(c).m("zoom-in"))},{default:R(()=>[B(s(Oe))]),_:1},8,["class"])],10,yt),s(g)?b("v-if",!0):(v(),S("span",{key:0,class:p(s(u).be("list","item-delete")),onClick:a=>$(o)},[B(s(A),{class:p(s(c).m("delete"))},{default:R(()=>[B(s(Be))]),_:1},8,["class"])],10,gt))],2)):b("v-if",!0)])],42,pt))),128)),L(f.$slots,"append")]),_:3},8,["class","name"]))}});var le=z(ht,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const bt=K({disabled:{type:Boolean,default:void 0}}),kt={file:r=>ge(r)},ie="ElUploadDrag",$t=H({name:ie,__name:"upload-dragger",props:bt,emits:kt,setup(r,{emit:d}){const t=d;je($e)||x(ie,"usage: <el-upload><el-upload-dragger /></el-upload>");const y=q("upload"),u=be(!1),c=V(),T=k=>{if(c.value)return;u.value=!1,k.stopPropagation();const $=Array.from(k.dataTransfer.files),f=k.dataTransfer.items||[];$.forEach((C,o)=>{var e;const a=f[o],l=(e=a?.webkitGetAsEntry)==null?void 0:e.call(a);l&&(C.isDirectory=l.isDirectory)}),t("file",$)},g=()=>{c.value||(u.value=!0)},w=k=>{k.currentTarget.contains(k.relatedTarget)||(u.value=!1)};return(k,$)=>(v(),S("div",{class:p([s(y).b("dragger"),s(y).is("dragover",u.value)]),onDrop:I(T,["prevent"]),onDragover:I(g,["prevent"]),onDragleave:I(w,["prevent"])},[L(k.$slots,"default")],34))}});var wt=z($t,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const Et=K({...Ee,beforeUpload:{type:m(Function),default:F},onRemove:{type:m(Function),default:F},onStart:{type:m(Function),default:F},onSuccess:{type:m(Function),default:F},onProgress:{type:m(Function),default:F},onError:{type:m(Function),default:F},onExceed:{type:m(Function),default:F}}),St=["tabindex","aria-disabled","onKeydown"],Ct=["name","disabled","multiple","accept"],Pt=H({name:"ElUploadContent",inheritAttrs:!1,__name:"upload-content",props:Et,setup(r,{expose:d}){const t=r,i=q("upload"),y=V(),u=Y({}),c=Y(),T=e=>{if(e.length===0)return;const{autoUpload:a,limit:l,fileList:E,multiple:n,onStart:h,onExceed:O}=t;if(l&&E.length+e.length>l){O(e,E);return}n||(e=e.slice(0,1));for(const U of e){const D=U;D.uid=Z(),h(D),a&&g(D)}},g=async e=>{if(c.value.value="",!t.beforeUpload)return k(e);let a,l={};try{const n=t.data,h=t.beforeUpload(e);l=te(t.data)?ne(t.data):t.data,a=await h,te(t.data)&&Ae(n,l)&&(l=ne(t.data))}catch{a=!1}if(a===!1){t.onRemove(e);return}let E=e;a instanceof Blob&&(a instanceof File?E=a:E=new File([a],e.name,{type:e.type})),k(Object.assign(E,{uid:e.uid}),l)},w=async(e,a)=>me(e)?e(a):e,k=async(e,a)=>{const{headers:l,data:E,method:n,withCredentials:h,name:O,action:U,onProgress:D,onSuccess:Se,onError:Ce,httpRequest:Pe}=t;try{a=await w(a??E,e)}catch{t.onRemove(e);return}const{uid:X}=e,G={headers:l||{},withCredentials:h,file:e,data:a,method:n,filename:O,action:U,onProgress:M=>{D(M,e)},onSuccess:M=>{Se(M,e),delete u.value[X]},onError:M=>{Ce(M,e),delete u.value[X]}},J=Pe(G);u.value[X]=J,J instanceof Promise&&J.then(G.onSuccess,G.onError)},$=e=>{const a=e.target.files;a&&T(Array.from(a))},f=()=>{y.value||(c.value.value="",c.value.click())},C=()=>{f()};return d({abort:e=>{Me(u.value).filter(e?([l])=>String(e.uid)===l:()=>!0).forEach(([l,E])=>{E instanceof XMLHttpRequest&&E.abort(),delete u.value[l]})},upload:g}),(e,a)=>(v(),S("div",{class:p([s(i).b(),s(i).m(e.listType),s(i).is("drag",e.drag),s(i).is("disabled",s(y))]),tabindex:s(y)?void 0:0,"aria-disabled":s(y),role:"button",onClick:f,onKeydown:ke(I(C,["self"]),["enter","space"])},[e.drag?(v(),_(wt,{key:0,disabled:s(y),onFile:T},{default:R(()=>[L(e.$slots,"default")]),_:3},8,["disabled"])):L(e.$slots,"default",{key:1}),N("input",{ref_key:"inputRef",ref:c,class:p(s(i).e("input")),name:e.name,disabled:s(y),multiple:e.multiple,accept:e.accept,type:"file",onChange:$,onClick:a[0]||(a[0]=I(()=>{},["stop"]))},null,42,Ct)],42,St))}});var ue=z(Pt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const de="ElUpload",ce=r=>{var d;(d=r.url)!=null&&d.startsWith("blob:")&&URL.revokeObjectURL(r.url)},Ft=(r,d)=>{const t=qe(r,"fileList",void 0,{passive:!0}),i=o=>t.value.find(e=>e.uid===o.uid);function y(o){var e;(e=d.value)==null||e.abort(o)}function u(o=["ready","uploading","success","fail"]){t.value=t.value.filter(e=>!o.includes(e.status))}function c(o){t.value=t.value.filter(e=>e.uid!==o.uid)}const T=o=>{Ie(()=>r.onChange(o,t.value))},g=(o,e)=>{const a=i(e);a&&(console.error(o),a.status="fail",c(a),r.onError(o,a,t.value),T(a))},w=(o,e)=>{const a=i(e);a&&(r.onProgress(o,a,t.value),a.status="uploading",a.percentage=Math.round(o.percent))},k=(o,e)=>{const a=i(e);a&&(a.status="success",a.response=o,r.onSuccess(o,a,t.value),T(a))},$=o=>{he(o.uid)&&(o.uid=Z());const e={name:o.name,percentage:0,status:"ready",size:o.size,raw:o,uid:o.uid};if(r.listType==="picture-card"||r.listType==="picture")try{e.url=URL.createObjectURL(o)}catch(a){We(de,a.message),r.onError(a,e,t.value)}t.value=[...t.value,e],T(e)},f=async o=>{const e=o instanceof File?i(o):o;e||x(de,"file to be removed not found");const a=l=>{y(l),c(l),r.onRemove(l,t.value),ce(l)};r.beforeRemove?await r.beforeRemove(e,t.value)!==!1&&a(e):a(e)};function C(){t.value.filter(({status:o})=>o==="ready").forEach(({raw:o})=>{var e;return o&&((e=d.value)==null?void 0:e.upload(o))})}return se(()=>r.listType,o=>{o!=="picture-card"&&o!=="picture"||(t.value=t.value.map(e=>{const{raw:a,url:l}=e;if(!l&&a)try{e.url=URL.createObjectURL(a)}catch(E){r.onError(E,e,t.value)}return e}))}),se(t,o=>{for(const e of o)e.uid||(e.uid=Z()),e.status||(e.status="success")},{immediate:!0,deep:!0}),{uploadFiles:t,abort:y,clearFiles:u,handleError:g,handleProgress:w,handleStart:$,handleSuccess:k,handleRemove:f,submit:C,revokeFileObjectURL:ce}},Tt=H({name:"ElUpload",__name:"upload",props:ut,setup(r,{expose:d}){const t=r,i=V(),y=Y(),{abort:u,submit:c,clearFiles:T,uploadFiles:g,handleStart:w,handleError:k,handleRemove:$,handleSuccess:f,handleProgress:C,revokeFileObjectURL:o}=Ft(t,y),e=P(()=>t.listType==="picture-card"),a=P(()=>({...t,fileList:g.value,onStart:w,onProgress:C,onSuccess:f,onError:k,onRemove:$}));return Ke(()=>{g.value.forEach(o)}),ze($e,{accept:He(t,"accept")}),d({abort:u,submit:c,clearFiles:T,handleStart:w,handleRemove:$}),(l,E)=>(v(),S("div",null,[e.value&&l.showFileList?(v(),_(le,{key:0,disabled:s(i),"list-type":l.listType,files:s(g),crossorigin:l.crossorigin,"handle-preview":l.onPreview,onRemove:s($)},ae({append:R(()=>[B(ue,oe({ref_key:"uploadRef",ref:y},a.value),{default:R(()=>[l.$slots.trigger?L(l.$slots,"trigger",{key:0}):b("v-if",!0),!l.$slots.trigger&&l.$slots.default?L(l.$slots,"default",{key:1}):b("v-if",!0)]),_:3},16)]),_:2},[l.$slots.file?{name:"default",fn:R(({file:n,index:h})=>[L(l.$slots,"file",{file:n,index:h})]),key:"0"}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):b("v-if",!0),!e.value||e.value&&!l.showFileList?(v(),_(ue,oe({key:1,ref_key:"uploadRef",ref:y},a.value),{default:R(()=>[l.$slots.trigger?L(l.$slots,"trigger",{key:0}):b("v-if",!0),!l.$slots.trigger&&l.$slots.default?L(l.$slots,"default",{key:1}):b("v-if",!0)]),_:3},16)):b("v-if",!0),l.$slots.trigger?L(l.$slots,"default",{key:2}):b("v-if",!0),L(l.$slots,"tip"),!e.value&&l.showFileList?(v(),_(le,{key:3,disabled:s(i),"list-type":l.listType,files:s(g),crossorigin:l.crossorigin,"handle-preview":l.onPreview,onRemove:s($)},ae({_:2},[l.$slots.file?{name:"default",fn:R(({file:n,index:h})=>[L(l.$slots,"file",{file:n,index:h})]),key:"0"}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):b("v-if",!0)]))}});var Lt=z(Tt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const _t=ye(Lt);export{_t as E};
