{"version":3,"file":"UserAvatar-uxcHnQB5.js","sources":["../../src/views/user/UserAvatar.vue"],"sourcesContent":["<script setup>\n    import PageContainer from \"@/components/PageContainer.vue\";\n    import { Plus,Upload } from '@element-plus/icons-vue'\n    import {ref} from 'vue'\n    import {useUserStore} from '@/stores'\n    import {userUpdateAvatarService} from '@/api/user'\n    import { ElMessage } from \"element-plus\";\n    //基于store数据初始化imgUrl\n\n    const userStore = useUserStore()\n    const imgUrl = ref(userStore.user.user_pic)\n    const uploadRef = ref()\n    const onSelectFile = (file)=>{\n        // 基于 FileReader 读取图片内容，实现预览效果\n        const reader = new FileReader()\n        reader.readAsDataURL(file.raw)\n        reader.onload = (e)=>{\n            imgUrl.value = e.target.result\n        }\n    }\n    const onUpdateAvatar = async ()=>{\n        //调用接口，完成头像上传\n        await userUpdateAvatarService(imgUrl.value)\n        //userStore重新渲染\n        await userStore.getUser()\n        ElMessage.success('更新头像成功')\n    }\n</script>\n\n<template>\n    <PageContainer title=\"更换头像\">\n        <el-upload\n            class=\"avatar-uploader\"\n            :show-file-list=\"false\"\n            :auto-upload=\"false\"\n            ref=\"uploadRef\"\n            :on-change=\"onSelectFile\"\n        >\n            <img v-if=\"imgUrl\" :src=\"imgUrl\" class=\"avatar\">\n            <el-icon v-else class=\"avatar-uploader-icon\"><Plus /></el-icon>\n        </el-upload>\n        <br />\n\n        <el-button @click=\"uploadRef.$el.querySelector('input').click()\" type=\"primary\" :icon=\"Plus\" size=\"large\">选择图片</el-button>\n        <el-button @click=\"onUpdateAvatar\" type=\"success\" :icon=\"Upload\" size=\"large\">上传头像</el-button>\n    </PageContainer>\n        \n</template>\n\n<style lang=\"scss\" scoped>\n    .avatar-uploader{\n    :deep(){\n        .avatar{\n            width: 278px;\n            height: 278px;\n            display: block;\n        }\n        .el-upload{\n            border:1px dashed var(--el-border-color);\n            border-radius:6px;\n            cursor:pointer;\n            position:relative;\n            overflow: hidden;\n            transition:var(--el-transition-duration-fast);\n        }\n        .el-upload:hover{\n            border-color:var(--el-color-primary);\n        }\n        .el-icon.avatar-uploader-icon{\n            font-size:28px;\n            color:#8c939d;\n            width: 278px;\n            height: 278px;\n            text-align: center;\n        }\n    }\n    \n}\n\n    </style>"],"names":["userStore","useUserStore","imgUrl","ref","uploadRef","onSelectFile","file","reader","e","onUpdateAvatar","userUpdateAvatarService","ElMessage","_createBlock","PageContainer","_createVNode","_component_el_upload","_createElementBlock","_component_el_icon","_unref","Plus","_createElementVNode","_component_el_button","_cache","Upload"],"mappings":"+XASI,MAAMA,EAAYC,EAAY,EACxBC,EAASC,EAAIH,EAAU,KAAK,QAAQ,EACpCI,EAAYD,EAAG,EACfE,EAAgBC,GAAO,CAEzB,MAAMC,EAAS,IAAI,WACnBA,EAAO,cAAcD,EAAK,GAAG,EAC7BC,EAAO,OAAUC,GAAI,CACjBN,EAAO,MAAQM,EAAE,OAAO,MAC5B,CACJ,EACMC,EAAiB,SAAU,CAE7B,MAAMC,EAAwBR,EAAO,KAAK,EAE1C,MAAMF,EAAU,QAAO,EACvBW,EAAU,QAAQ,QAAQ,CAC9B,6CAIAC,EAegBC,EAAA,CAfD,MAAM,QAAM,WACvB,IASY,CATZC,EASYC,EAAA,CARR,MAAM,kBACL,iBAAgB,GAChB,cAAa,WACV,YAAJ,IAAIX,EACH,YAAWC,cAEZ,IAAgD,CAArCH,EAAA,WAAXc,EAAgD,MAAA,OAA5B,IAAKd,EAAA,MAAQ,MAAM,0BACvCU,EAA+DK,EAAA,OAA/C,MAAM,mCAAuB,IAAQ,CAARH,EAAQI,EAAAC,CAAA,CAAA,mCAEzDC,EAAM,KAAA,KAAA,KAAA,EAAA,GAENN,EAA0HO,EAAA,CAA9G,uBAAOjB,EAAA,MAAU,IAAI,uBAAuB,MAAK,GAAI,KAAK,UAAW,KAAMc,EAAAC,CAAA,EAAM,KAAK,oBAAQ,IAAI,CAAA,GAAAG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAJ,OAAI,EAAA,uBAC9GR,EAA8FO,EAAA,CAAlF,QAAOZ,EAAgB,KAAK,UAAW,KAAMS,EAAAK,CAAA,EAAQ,KAAK,oBAAQ,IAAI,CAAA,GAAAD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAJ,OAAI,EAAA"}