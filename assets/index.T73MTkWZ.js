import{l as e,P as n,ak as o,Q as t,I as a,G as s,X as l,R as r,a0 as i,_ as c,a as u,Y as d,g as p,o as f,w as m,ag as v,v as g,x as h,h as b,a6 as y,n as C,J as E,a1 as x,j as w,aq as B,a$ as M,r as k,ah as I,B as T,T as L,bb as R,K as z,bc as _,c as P,ae as S,bd as A,be as $,bf as V,s as O,aG as j,aM as D,H,aO as X,aT as Y,bg as K,bh as q,f as F,b9 as U,ad as G}from"./index.BmsgrFcj.js";import{E as W,a as J}from"./_plugin-vue_export-helper.DnIr6MF_.js";import{o as Q,E as Z}from"./el-input.hbMfxXk5.js";import{c as N,d as ee,j as ne,i as oe}from"./el-overlay.B5sZJrkx.js";const te=(s,l,r,i)=>{const c={offsetX:0,offsetY:0},u=e(!1),d=(e,n)=>{if(s.value){const{offsetX:o,offsetY:t}=c,l=s.value.getBoundingClientRect(),r=l.left,u=l.top,d=l.width,p=l.height,f=document.documentElement.clientWidth,m=document.documentElement.clientHeight,v=-r+o,g=-u+t,h=f-r-d+o,b=m-u-(p<m?p:0)+t;(null==i?void 0:i.value)||(e=Math.min(Math.max(e,v),h),n=Math.min(Math.max(n,g),b)),c.offsetX=e,c.offsetY=n,s.value.style.transform=`translate(${a(e)}, ${a(n)})`}},p=e=>{const n=e.clientX,o=e.clientY,{offsetX:t,offsetY:a}=c,s=e=>{u.value||(u.value=!0);const s=t+e.clientX-n,l=a+e.clientY-o;d(s,l)},l=()=>{u.value=!1,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",l)},f=()=>{l.value&&s.value&&(l.value.removeEventListener("mousedown",p),window.removeEventListener("resize",m))},m=()=>{const{offsetX:e,offsetY:n}=c;d(e,n)};return n(()=>{o(()=>{r.value?l.value&&s.value&&(l.value.addEventListener("mousedown",p),window.addEventListener("resize",m)):f()})}),t(()=>{f()}),{isDragging:u,resetPosition:()=>{c.offsetX=0,c.offsetY=0,s.value&&(s.value.style.transform="")},updatePosition:m}},ae=(...e)=>n=>{e.forEach(e=>{e.value=n})},se="_trap-focus-children",le=[],re=e=>{if(0===le.length)return;const n=r(e),o=le[le.length-1][se];if(o.length>0&&n===i.tab){if(1===o.length)return e.preventDefault(),void(document.activeElement!==o[0]&&o[0].focus());const n=e.shiftKey,t=e.target===o[0],a=e.target===o[o.length-1];t&&n&&(e.preventDefault(),o[o.length-1].focus()),a&&!n&&(e.preventDefault(),o[0].focus())}},ie=u({name:"ElMessageBox",directives:{TrapFocus:{beforeMount(e){e[se]=Q(e),le.push(e),le.length<=1&&document.addEventListener("keydown",re)},updated(e){l(()=>{e[se]=Q(e)})},unmounted(){le.shift(),0===le.length&&document.removeEventListener("keydown",re)}}},components:{ElButton:W,ElFocusTrap:ee,ElInput:Z,ElOverlay:N,ElIcon:z,...R},inheritAttrs:!1,props:{buttonSize:{type:String,validator:e=>["",...s].includes(e)},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:Boolean,container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(o,{emit:a}){const{locale:s,zIndex:r,ns:i,size:c}=_("message-box",P(()=>o.buttonSize)),{t:u}=s,{nextZIndex:d}=r,p=e(!1),f=S({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:A($),cancelButtonLoadingIcon:A($),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:d()}),m=P(()=>{const e=f.type;return{[i.bm("icon",e)]:e&&V[e]}}),v=J(),g=J(),h=P(()=>{const e=f.type;return f.icon||e&&V[e]||""}),b=P(()=>!!f.message),y=e(),C=e(),E=e(),x=e(),w=e(),B=P(()=>f.confirmButtonClass);O(()=>f.inputValue,async e=>{await l(),"prompt"===o.boxType&&e&&X()},{immediate:!0}),O(()=>p.value,e=>{var n,t;e&&("prompt"!==o.boxType&&(f.autofocus?E.value=null!=(t=null==(n=w.value)?void 0:n.$el)?t:y.value:E.value=y.value),f.zIndex=d()),"prompt"===o.boxType&&(e?l().then(()=>{var e;x.value&&x.value.$el&&(f.autofocus?E.value=null!=(e=Y())?e:y.value:E.value=y.value)}):(f.editorErrorMessage="",f.validateError=!1))});const M=P(()=>o.draggable),k=P(()=>o.overflow),{isDragging:I}=te(y,C,M,k);function T(){p.value&&(p.value=!1,l(()=>{f.action&&a("action",f.action)}))}n(async()=>{await l(),o.closeOnHashChange&&window.addEventListener("hashchange",T)}),t(()=>{o.closeOnHashChange&&window.removeEventListener("hashchange",T)});const L=()=>{o.closeOnClickModal&&z(f.distinguishCancelAndClose?"close":"cancel")},R=oe(L),z=e=>{var n;("prompt"!==o.boxType||"confirm"!==e||X())&&(f.action=e,f.beforeClose?null==(n=f.beforeClose)||n.call(f,e,f,T):T())},X=()=>{if("prompt"===o.boxType){const e=f.inputPattern;if(e&&!e.test(f.inputValue||""))return f.editorErrorMessage=f.inputErrorMessage||u("el.messagebox.error"),f.validateError=!0,!1;const n=f.inputValidator;if(D(n)){const e=n(f.inputValue);if(!1===e)return f.editorErrorMessage=f.inputErrorMessage||u("el.messagebox.error"),f.validateError=!0,!1;if(H(e))return f.editorErrorMessage=e,f.validateError=!0,!1}}return f.editorErrorMessage="",f.validateError=!1,!0},Y=()=>{var e,n;const o=null==(e=x.value)?void 0:e.$refs;return null!=(n=null==o?void 0:o.input)?n:null==o?void 0:o.textarea},K=()=>{z("close")};return o.lockScroll&&ne(p,{ns:i}),{...j(f),ns:i,overlayEvent:R,visible:p,hasMessage:b,typeClass:m,contentId:v,inputId:g,btnSize:c,iconComponent:h,confirmButtonClasses:B,rootRef:y,focusStartRef:E,headerRef:C,inputRef:x,isDragging:I,confirmRef:w,doClose:T,handleClose:K,onCloseRequested:()=>{o.closeOnPressEscape&&K()},handleWrapperClick:L,handleInputEnter:e=>{if("textarea"!==f.inputType)return e.preventDefault(),z("confirm")},handleAction:z,t:u}}}),ce=["aria-label","aria-describedby"],ue=["aria-label"],de=["id"];var pe=c(ie,[["render",function(e,n,o,t,a,s){const l=d("el-icon"),r=d("el-input"),i=d("el-button"),c=d("el-focus-trap"),u=d("el-overlay");return f(),p(L,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=n=>e.$emit("vanish")),persisted:""},{default:m(()=>[v(g(u,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:m(()=>[h("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:b(`${e.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...n)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...n)),onMousedown:n[9]||(n[9]=(...n)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...n)),onMouseup:n[10]||(n[10]=(...n)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...n))},[g(c,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:m(()=>[h("div",{ref:"rootRef",class:b([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),e.ns.is("dragging",e.isDragging),{[e.ns.m("center")]:e.center}]),style:C(e.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=y(()=>{},["stop"]))},[null!==e.title&&void 0!==e.title?(f(),E("div",{key:0,ref:"headerRef",class:b([e.ns.e("header"),{"show-close":e.showClose}])},[h("div",{class:b(e.ns.e("title"))},[e.iconComponent&&e.center?(f(),p(l,{key:0,class:b([e.ns.e("status"),e.typeClass])},{default:m(()=>[(f(),p(w(e.iconComponent)))]),_:1},8,["class"])):x("v-if",!0),h("span",null,B(e.title),1)],2),e.showClose?(f(),E("button",{key:0,type:"button",class:b(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:n[0]||(n[0]=n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=M(y(n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[g(l,{class:b(e.ns.e("close"))},{default:m(()=>[(f(),p(w(e.closeIcon||"close")))]),_:1},8,["class"])],42,ue)):x("v-if",!0)],2)):x("v-if",!0),h("div",{id:e.contentId,class:b(e.ns.e("content"))},[h("div",{class:b(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(f(),p(l,{key:0,class:b([e.ns.e("status"),e.typeClass])},{default:m(()=>[(f(),p(w(e.iconComponent)))]),_:1},8,["class"])):x("v-if",!0),e.hasMessage?(f(),E("div",{key:1,class:b(e.ns.e("message"))},[k(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(f(),p(w(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(f(),p(w(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0,textContent:B(e.message)},null,8,["for","textContent"]))])],2)):x("v-if",!0)],2),v(h("div",{class:b(e.ns.e("input"))},[g(r,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":n[2]||(n[2]=n=>e.inputValue=n),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:b({invalid:e.validateError}),onKeydown:M(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),h("div",{class:b(e.ns.e("errormsg")),style:C({visibility:e.editorErrorMessage?"visible":"hidden"})},B(e.editorErrorMessage),7)],2),[[I,e.showInput]])],10,de),h("div",{class:b(e.ns.e("btns"))},[e.showCancelButton?(f(),p(i,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:b([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:n[3]||(n[3]=n=>e.handleAction("cancel")),onKeydown:n[4]||(n[4]=M(y(n=>e.handleAction("cancel"),["prevent"]),["enter"]))},{default:m(()=>[T(B(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size"])):x("v-if",!0),v(g(i,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:b([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:n[5]||(n[5]=n=>e.handleAction("confirm")),onKeydown:n[6]||(n[6]=M(y(n=>e.handleAction("confirm"),["prevent"]),["enter"]))},{default:m(()=>[T(B(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size"]),[[I,e.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,ce)]),_:3},8,["z-index","overlay-class","mask"]),[[I,e.visible]])]),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const fe=new Map,me=(e,n,o=null)=>{const t=g(pe,e,D(e.message)||Y(e.message)?{default:D(e.message)?e.message:()=>e.message}:null);return t.appContext=o,K(t,n),(e=>{let n=document.body;return e.appendTo&&(H(e.appendTo)&&(n=document.querySelector(e.appendTo)),U(e.appendTo)&&(n=e.appendTo),U(n)||(n=document.body)),n})(e).appendChild(n.firstElementChild),t.component},ve=(e,n)=>{const o=document.createElement("div");e.onVanish=()=>{K(null,o),fe.delete(a)},e.onAction=n=>{const o=fe.get(a);let s;s=e.showInput?{value:a.inputValue,action:n}:n,e.callback?e.callback(s,t.proxy):"cancel"===n||"close"===n?e.distinguishCancelAndClose&&"cancel"!==n?o.reject("close"):o.reject("cancel"):o.resolve(s)};const t=me(e,o,n),a=t.proxy;for(const s in e)q(e,s)&&!q(a.$props,s)&&("closeIcon"===s&&F(e[s])?a[s]=A(e[s]):a[s]=e[s]);return a.visible=!0,a};function ge(e,n=null){if(!X)return Promise.reject();let o;return H(e)||Y(e)?e={message:e}:o=e.callback,new Promise((t,a)=>{const s=ve(e,null!=n?n:ge._context);fe.set(s,{options:e,callback:o,resolve:t,reject:a})})}const he={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach(e=>{ge[e]=function(e){return(n,o,t,a)=>{let s="";return F(o)?(t=o,s=""):s=G(o)?"":o,ge(Object.assign({title:s,message:n,type:"",...he[e]},t,{boxType:e}),a)}}(e)}),ge.close=()=>{fe.forEach((e,n)=>{n.doClose()}),fe.clear()},ge._context=null;const be=ge;be.install=e=>{be._context=e._context,e.config.globalProperties.$msgbox=be,e.config.globalProperties.$messageBox=be,e.config.globalProperties.$alert=be.alert,e.config.globalProperties.$confirm=be.confirm,e.config.globalProperties.$prompt=be.prompt};const ye=be;export{ye as E,ae as c,te as u};
