{"version":3,"file":"UserPassword-CPFQASmo.js","sources":["../../src/views/user/UserPassword.vue"],"sourcesContent":["<script setup>\nimport { ref  } from 'vue'\nimport { userUpdatePwdService } from '@/api/user'\nimport { ElMessage } from 'element-plus'\nimport PageContainer from '@/components/PageContainer.vue'\nimport { useUserStore } from '@/stores'\nimport { useRouter } from 'vue-router'\nconst pwdForm = ref({\n  old_pwd: '',\n  new_pwd: '',\n  re_pwd: ''\n})\n\nconst pwdFormRef = ref()\n\nconst userStore = useUserStore()\n\nconst rules = {\n  old_pwd: [\n    { required: true, message: '请输入原密码', trigger: 'blur' },\n    { min: 6, max: 15, message: '密码长度在6到15位', trigger: 'blur' }\n  ],\n  new_pwd: [\n    { required: true, message: '请输入新密码', trigger: 'blur' },\n    { min: 6, max: 15, message: '密码长度在6到15位', trigger: 'blur' },\n    {\n      validator: (rule, value, callback) => {\n        if (value === pwdForm.value.old_pwd) {\n          callback(new Error('新密码不能与原密码相同'))\n        } else {\n          callback()\n        }\n      },\n      trigger: 'blur'\n    }\n  ],\n  re_pwd: [\n    { required: true, message: '请再次输入新密码', trigger: 'blur' },\n    { min: 6, max: 15, message: '密码长度在6到15位', trigger: 'blur' },\n    {\n      validator: (rule, value, callback) => {\n        if (value !== pwdForm.value.new_pwd) {\n          callback(new Error('两次输入密码不一致'))\n        } else {\n          callback()\n        }\n      },\n      trigger: 'blur'\n    }\n  ]\n}\n\nconst router = useRouter()\n\nconst submitForm = async() => {\n  await pwdFormRef.value.validate()\n  await userUpdatePwdService(pwdForm.value)\n    ElMessage.success('修改密码成功')\n\n    //密码修改成功后，退出重新登录\n    userStore.setUser({})\n    userStore.setToken('')\n\n    //拦截登录\n    router.push('/login')\n\n\n}\n\nconst resetForm = () => {\n  pwdFormRef.value.resetFields()\n}\n</script>\n\n<template>\n    <page-container title=\"修改密码\">\n  \n    <el-form\n      :model=\"pwdForm\"\n      :rules=\"rules\"\n      ref=\"pwdFormRef\"\n      label-width=\"100px\"\n      class=\"demo-ruleForm\"\n      style=\"width:50%\"\n    >\n      <el-form-item label=\"原密码\" prop=\"old_pwd\">\n        <el-input\n          v-model=\"pwdForm.old_pwd\"\n          type=\"password\"\n          placeholder=\"请输入原密码\"\n        />\n      </el-form-item>\n      <el-form-item label=\"新密码\" prop=\"new_pwd\">\n        <el-input\n          v-model=\"pwdForm.new_pwd\"\n          type=\"password\"\n          placeholder=\"请输入新密码\"\n        />\n      </el-form-item>\n      <el-form-item label=\"确认密码\" prop=\"re_pwd\">\n        <el-input\n          v-model=\"pwdForm.re_pwd\"\n          type=\"password\"\n          placeholder=\"请输入确认密码\"\n        />\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submitForm\">修改密码</el-button>\n        <el-button @click=\"resetForm\">重置</el-button>\n      </el-form-item>\n    </el-form>\n    </page-container>\n</template>\n\n\n\n<style scoped>\n.user-password {\n  max-width: 600px;\n  margin: 0 auto;\n}\n</style>"],"names":["pwdForm","ref","pwdFormRef","userStore","useUserStore","rules","rule","value","callback","router","useRouter","submitForm","userUpdatePwdService","ElMessage","resetForm","_createBlock","PageContainer","_createVNode","_component_el_form","_component_el_form_item","_component_el_input","_cache","$event","_component_el_button"],"mappings":"qYAOA,MAAMA,EAAUC,EAAI,CAClB,QAAS,GACT,QAAS,GACT,OAAQ,EACV,CAAC,EAEKC,EAAaD,EAAG,EAEhBE,EAAYC,EAAY,EAExBC,EAAQ,CACZ,QAAS,CACP,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,MAAM,EACpD,CAAE,IAAK,EAAG,IAAK,GAAI,QAAS,aAAc,QAAS,MAAM,CAC7D,EACE,QAAS,CACP,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,MAAM,EACpD,CAAE,IAAK,EAAG,IAAK,GAAI,QAAS,aAAc,QAAS,MAAM,EACzD,CACE,UAAW,CAACC,EAAMC,EAAOC,IAAa,CAChCD,IAAUP,EAAQ,MAAM,QAC1BQ,EAAS,IAAI,MAAM,aAAa,CAAC,EAEjCA,EAAQ,CAEZ,EACA,QAAS,MACf,CACA,EACE,OAAQ,CACN,CAAE,SAAU,GAAM,QAAS,WAAY,QAAS,MAAM,EACtD,CAAE,IAAK,EAAG,IAAK,GAAI,QAAS,aAAc,QAAS,MAAM,EACzD,CACE,UAAW,CAACF,EAAMC,EAAOC,IAAa,CAChCD,IAAUP,EAAQ,MAAM,QAC1BQ,EAAS,IAAI,MAAM,WAAW,CAAC,EAE/BA,EAAQ,CAEZ,EACA,QAAS,MACf,CACA,CACA,EAEMC,EAASC,EAAS,EAElBC,EAAa,SAAW,CAC5B,MAAMT,EAAW,MAAM,SAAQ,EAC/B,MAAMU,EAAqBZ,EAAQ,KAAK,EACtCa,EAAU,QAAQ,QAAQ,EAG1BV,EAAU,QAAQ,CAAA,CAAE,EACpBA,EAAU,SAAS,EAAE,EAGrBM,EAAO,KAAK,QAAQ,CAGxB,EAEMK,EAAY,IAAM,CACtBZ,EAAW,MAAM,YAAW,CAC9B,iDAIIa,EAoCiBC,EAAA,CApCD,MAAM,QAAM,WAE5B,IAiCU,CAjCVC,EAiCUC,EAAA,CAhCP,MAAOlB,EAAA,MACP,MAAOK,UACJ,aAAJ,IAAIH,EACJ,cAAY,QACZ,MAAM,gBACN,MAAA,CAAA,MAAA,KAAA,cAEA,IAMe,CANfe,EAMeE,EAAA,CAND,MAAM,MAAM,KAAK,sBAC7B,IAIE,CAJFF,EAIEG,EAAA,CAHS,WAAApB,EAAA,MAAQ,QAAR,sBAAAqB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAtB,EAAA,MAAQ,QAAOsB,GACxB,KAAK,WACL,YAAY,yCAGhBL,EAMeE,EAAA,CAND,MAAM,MAAM,KAAK,sBAC7B,IAIE,CAJFF,EAIEG,EAAA,CAHS,WAAApB,EAAA,MAAQ,QAAR,sBAAAqB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAtB,EAAA,MAAQ,QAAOsB,GACxB,KAAK,WACL,YAAY,yCAGhBL,EAMeE,EAAA,CAND,MAAM,OAAO,KAAK,qBAC9B,IAIE,CAJFF,EAIEG,EAAA,CAHS,WAAApB,EAAA,MAAQ,OAAR,sBAAAqB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAtB,EAAA,MAAQ,OAAMsB,GACvB,KAAK,WACL,YAAY,0CAGhBL,EAGeE,EAAA,KAAA,WAFb,IAA8D,CAA9DF,EAA8DM,EAAA,CAAnD,KAAK,UAAW,QAAOZ,cAAY,IAAI,CAAA,GAAAU,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAJ,OAAI,EAAA,YAClDJ,EAA4CM,EAAA,CAAhC,QAAOT,CAAS,EAAA,WAAE,IAAE,CAAA,GAAAO,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,KAAE,EAAA"}